<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <title>Map match GeoJSONs from GitHub</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <script src="https://api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.js"></script>
    <link href="https://api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.css" rel="stylesheet" />
    <script src="../leaflet-mapmatch.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
        }
        
        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <!-- jQuery is required for this example. -->
    <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script>
        // Provide your access token
        L.mapbox.accessToken = 'pk.eyJ1IjoicGxhbmVtYWQiLCJhIjoiemdYSVVLRSJ9.g3lbg_eN0kztmsfIPxa9MQ';

        var map = L.mapbox.map('map', 'mapbox.streets');
        var featureLayer = L.mapbox.featureLayer().addTo(map);

        var url = 'https://raw.githubusercontent.com/mapbox/leaflet-mapmatch/master/test/a.geojson';

        function load() {
            // Fetch just the contents of a .geojson file from GitHub
            // https://www.mapbox.com/mapbox.js/example/v1.0.0/geojson-marker-from-remote-url/
            $.ajax({
                headers: {
                    'Accept': 'application/vnd.github.v3.raw'
                },
                xhrFields: {
                    withCredentials: false
                },
                dataType: 'json',
                url: url,
                success: function (geojson) {
                    // On success add fetched data to the map.
                    featureLayer.setGeoJSON(geojson).setStyle({
                        weight: 2,
                        color: 'red',
                        dashArray: '4,4',
                        opacity: 0.5
                    });
                    
                    map.fitBounds(featureLayer.getBounds());

                    // Try mapmatch the geojson
                    mapmatch.mapmatch(geojson, function (error, featureLayer) {

                        featureLayer.addTo(map);

                        featureLayer.setStyle({
                            weight: 2,
                            color: 'black',
                            dashArray: '',
                            opacity: 1
                        });

                    });
                }
            });
        }

        $(load);
    </script>
</body>

</html>